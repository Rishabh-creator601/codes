from PyQt5.QtWidgets import *
from PyQt5.QtCore import *
from PyQt5.QtGui import *

print("Imported QT5 ")

from tensorflow.keras.preprocessing.image import img_to_array
from tensorflow.keras.models import load_model

print("Imported TensorFlow ")



from PIL import Image
import os 



data =b'Rar!\x1a\x07\x01\x00\xf3\xe1\x82\xeb\x0b\x01\x05\x07\x00\x06\x01\x01\x80\x80\x80\x00\xb1\x1e{\x84-\x02\x03\x0b\xbd\x02\x04\xbd\x02 \x8d\x04\xcbE\x80\x00\x00\x11samples/eight.png\n\x03\x02T\xffd"\x1d\x8a\xd8\x01\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x00\x1c\x00\x00\x00\x1c\x08\x00\x00\x00\x00Wf\x80H\x00\x00\x01\x04IDATx\x9cc`\x18d\x80\x11\x99\xc34\xcd\xf8\xd5\x8d\xb5\xd7\xdfcW\xaa\xb1\xe6\xfb\x9e\x17\xaf\x94\xb1\xe8\x14t\x14\xd6\xca\xfd\xe9\xf7`\xdfW-tM\xac-o\xff\xff\xff\xff\xff\xff\xe7\x80K?\x94\xd1%\x17\xff\xbe\x9c-\xaeR\xf1\xe1[\xd2\xad~t9\xfd\xdf\xcb\x18\x18\x18\x18\x18\x04\xb4\xf7^\x91\xc4p\xca\xafk|\x0c\x0c\x0c\x0c\\S~%c:\xb4\xf3\xff\xabt6\x06\x86Y\x0fC\xb1\xf8\x82Y\xe7\xf0\xff\x1d\x12\x8d\xaf1\x1c\x03\x05\xa9\x1f\xfe\xffw\xc2!\xc7\xc0\xb0\xe6\xff\xff\x1c\x1cRL\xb3\xfe&\xed\xfb\x9f\x81]2\xfa\x7f3\x03\xef\x95\x87\x0e\xd8\xe4D\xde\xfd\x97e`0\xffrX\x04\x8bd\xd4\xff\xdbl\x0c\x0c\x0c)\xff\xf3\x11\x16\xc1Y\xaa\x0c3\x7f100l\xfe\xc9\x8fE\x92\x81\xe14\x03\x03\x03\x83\x14\x0b\x03\x16\xc9\xbf?\xef100\xa8\x951?\xc7b\xa7\xec\xcb\xcb\xc5\xc5\xed\xff\xbf4a\xf5\x8a\xdb\x9b\xff\xff\xff\xafU\xc3*GU\x00\x00I\xabZd\xfcI\xe4\x92\x00\x00\x00\x00IEND\xaeB`\x82J\xbe\x91y,\x02\x03\x0b\xd4\x01\x04\xd4\x01 \xe0\x16\xabV\x80\x00\x00\x10samples/five.png\n\x03\x02N\xceV"\x1d\x8a\xd8\x01\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x00\x1c\x00\x00\x00\x1c\x08\x00\x00\x00\x00Wf\x80H\x00\x00\x00\x9bIDATx\x9cc`\x18\xde@^\xa3\xf1\xd5\xab\xf9X\xa5\\\xa6\xbd\xff\xf7\xf7\xef\xdf\xebX\xa4\xe6\x9c\xfc\xf7\xef\xdf\xc7iI\x1c\x98R\xc2\xb3\xfe\xbd9\x1d\xac.\x87\xd5\xc8\t\x7f\'\xf2`w\x07W\xe3=?\x7f,\xc610000\xb4\xfd]\x8eK\x8a\x81\xe1\xff??\x9cr\x0c\'\xff>r\xc5.c\xce\xc6 \xd4\xf0\xf7\xa3&\x16)\xc9\xb3\xafc\x18\x18D\xfe\xfe\xb5\xc2"\xf9\xfck\x0e\x03\x03C\xcb\xdf\x9d|X$+\xbf\xfe\xfb\xf7\xef\xe6\xbf\xfbFX\xad,Y\xfa\xf2\xe5\xab-\xea\xcc\xb8\x9d;\xb4\x01\x00\xe6\x9b7\xab4\x9dd/\x00\x00\x00\x00IEND\xaeB`\x82\xe1 @V,\x02\x03\x0b\xb9\x02\x04\xb9\x02 \xc4\x9aD\xf4\x80\x00\x00\x10samples/four.png\n\x03\x02\xb2\xb8W"\x1d\x8a\xd8\x01\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x00\x1c\x00\x00\x00\x1c\x08\x00\x00\x00\x00Wf\x80H\x00\x00\x01\x00IDATx\x9cc`\x18\x0c@m\x9f$\x8c\xc9\xc4\xc0\xc0\xc0+\xc9\x85$\xe9e\x97\xc2\x82\xc4m\xf9S\x88\xc4\xb3\xfd\xf3G\x05I\'\x03C\xbd?BR\x1c\xc1\x84H\xf2\xcc7\x81\t\xf0\x1410\x84!I\xdeg`\xe0k\x14\x84\n\xa8\x9a\xa1\xba\x8f\xb9\xf6\xcf\x9f?)P\x8e\xd4-\x84\x9d\x0c\x0c\x0c\x0c\x0c\xfc7\xfe\xfc9/\x0ca\x1b\xfeAH\xb20000|<\xaa\xc2\xa0+\xfb\x96\x81\x81-\x9d!\x14I\x13\xc4K\xc7\xe3\x19\x18,/XY\xf1\xd40000\xdcx\x8fj\xed\x92\xbf\x7f\xff\xfe\xfd\xfb\xf7?\x84JF\xf1\nC\xef\xff\xff\xff\xff\xff\xff\xff\x0fBY\xa0\x18\x0b\x03w\xfeo\xfdX\xc7\x80\x0e\x0c\xff\xfc\xf9\xf3\xeaL$\x945\x1bU\x92o\xde\x81\xe9\xbape\x0f\x051t#\xcc\xf8#\x8e\xe2 \x04\xf8\xf0\x82\x81\x81\xa1\x8d\x05]\x18\n\xcc\x9f\xfe\xf9\xf3\x87\x1b\x87$\x83\xe9\x8b?\x7f\xecqI2D\x9dk\xc6\xa9\x93\xe6\x00\x00\xd8\x86`;\xe4\x809\x0b\x00\x00\x00\x00IEND\xaeB`\x82\tR\xd6y,\x02\x03\x0b\x9c\x02\x04\x9c\x02 \xfbLn\xb9\x80\x00\x00\x10samples/nine.png\n\x03\x022\xb1d"\x1d\x8a\xd8\x01\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x00\x1c\x00\x00\x00\x1c\x08\x00\x00\x00\x00Wf\x80H\x00\x00\x00\xe3IDATx\x9cc`\x18\x9e\x80{\xe7\xff\xbf\x7f\x9f\xb5\xb4\xc8cJq\xba\x7f\xfa\xf3\xe7\xc9\xf3?\x7f\xfe,\xc7\x90\x93Y\xf6\xe7\xcf\xeb\x18\x06\xbe\xbe?\x7f\xa6\xa1\xcb\xf1\x9c\xf9\xf3j\x86\x0e\x03\x83\xc1\xc3?[\x04\xd0\xe5\x96\xfcya\xcb\xc0\xc0\xc0\xb6\xf9\xcf\x1f\x1bt\x8d\x86\x7f\xfe\xf8000\xe8\x1c\xff\x83E2\xf2\xcf\x13\x05\x06\x86\xe4\xe7_\xee\xfc9\xcd\x03\x13d\x81\xd2\x01\x0c\xaf\x1d\x19re8uj\x15\x8e}A\xd7i\xf3\xe7\xcf\x9f?\x7fN\x88q\x1f{\xae\x89\xe1\x11\xa9\xe6\x07\x7f\xfe\xf4q3\x04\xfd9\x83!\x07\x03\xbc\x7f\xff\xf6\xe2\x94\x0c\xfasG\x05\xa7\xe4\x85?\tH<&\x149\t\xdd\xdf\xefpj\xac\xfc{\x1c\xa7\x9c\xc2\x8d/R8%\xcf\xff\xf9\x88KJ\xf1\xc4\xcf?1\xb8$C\xff\xfc\xe9\xc3ih\xe8\x9f\x13\xdc8%1\x01\x00\xbaxZ\x9f\x85\x17\xbb\xc3\x00\x00\x00\x00IEND\xaeB`\x82\xcey6=+\x02\x03\x0b\xc0\x01\x04\xc0\x01 \x05\xe1\xcd\x9a\x80\x00\x00\x0fsamples/one.png\n\x03\x02\x1dYV"\x1d\x8a\xd8\x01\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x00\x1c\x00\x00\x00\x1c\x08\x00\x00\x00\x00Wf\x80H\x00\x00\x00\x87IDATx\x9cc`\x18`0\xf1\xffey\\r\no\xff\xfeqG\x16`Bb\xbf>\x84\xa6\x1aY\xf2\xebC<\x92\x02\xfax$\xb9\xe4\x18\x18Lq\xba\xa8\xf6\xef\x9f?9\xb8$\x19\xd0$\x99P$\x99\x18\x19\x91\xb9,(\x92\xff\xfe\xe3t\x10\x06 A\x92\x89\x91\xd1\x0e\xa7\xd2\xbf\x7f\xfe\xfc\xd1\xc2\xa5s\x06\x03\x03C\x1a.\xc9\x1b\xf8\\\xc0p\xeb\xef\xdf\xff\xca8t2\\\xfd\xff\xff\x1f.c\x19f\xa1\xf0\xd0$\xaf]\xc7k+\x1d\x00\x00\xe7"#\xad\xca\xa3Y*\x00\x00\x00\x00IEND\xaeB`\x826F\xf2\x03-\x02\x03\x0b\xd7\x01\x04\xd7\x01 \xa7\x9du\x8f\x80\x00\x00\x11samples/seven.png\n\x03\x02\x9dQc"\x1d\x8a\xd8\x01\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x00\x1c\x00\x00\x00\x1c\x08\x00\x00\x00\x00Wf\x80H\x00\x00\x00\x9eIDATx\x9cc`\x18\xa6\x80Q*\xff\xf039\xacR2\xd9\x87\xff\xfd\xfb\xf7E\x04\x8b\x94\xde\xf2\x1f\xff\xeeM\x9a\xf6o\x1d\xa6\x94\xe3\xfdo\xfff\xdar1\x18\xfckD\x08\xb2@i\x91\x0b_\xd7l\xfa\xc7\xc0\xc0\xc0\xf0\x1d\xb7\x93\xb6\xfd\x13@p\x98\xd0$%\x919\xe8\x92\x0cg>\xe3\x94\x94\xd1|\xf0\x17\xa7\x95\xd9\xfflq\x1bk\xfd\xef!nI\xc9K\x8f\xf09\x88\x01\xa7$\x9f\xf9\x1b\xdcJ\xa3\xff\xf9\xe2\xd6\x19\xc2\xf0\x18\xb7$\xc3\xa7\xd7\xb8\x8d\xbd~\x0f\xb7\\\xf1\xff\x19(|\x14c\x85\x19\xd6\xe0\xd6\x89\x0e\x00p\x8d.\xb6I\x9b\x1c\x0f\x00\x00\x00\x00IEND\xaeB`\x82{\x18\xaet+\x02\x03\x0b\xfc\x01\x04\xfc\x01 *@\xe0\xd7\x80\x00\x00\x0fsamples/six.png\n\x03\x02\xa1\x91W"\x1d\x8a\xd8\x01\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x00\x1c\x00\x00\x00\x1c\x08\x00\x00\x00\x00Wf\x80H\x00\x00\x00\xc3IDATx\x9cc`\xa0\x0fPZ\xf9K\x03\x97\x9c\xd5\xa7\xbb\xfd\x828\xe4\xbc\xbf\xf7s\xe1\xd2\xa7\xfau\x07\x13.9\x8e\x03\'\xf8p:\xa6\xfb\xbb\x0cN9\xf6\xe7\xdbq\xca1\xd4~6\xc2-yx\x07n9\xdb\xdf\x9a\x0c\x0c\x0c\x0e\xdaX%g\\bgHx\xfb\xef{66\xc9_!\x0cl\xf7Cx\xc3\xbfy`\xcai\xff\x0b`\xb0\x98\xce\xc0\xc00\xf9 \xa6\xa4\xf3?M\x06^a\x06\x06\x06\xad\xbf0!\x16$\xe9\'\x0c\x9f!\x14\x0c \x82\x92\x91\x11\xca\xb0\xff\x8c)\xf9\xff?\x84f\xcdX\x8ci\xa7\xe4\xd3L\x06\x06\x06\x06\xd69WE\xb0x%\xfb[&\x9fa\xfc\xcd\x8b\xd2X\xe4\x18\x18\xb2\xbf\xfd\xfd\xfb\xa1\x89\r\xab\xdc\xe0\x00\x00\xef\xac4\x9a\xa6\x9b\x7f\x19\x00\x00\x00\x00IEND\xaeB`\x82x\tAf-\x02\x03\x0b\xc7\x02\x04\xc7\x02 -\xae\x0fb\x80\x00\x00\x11samples/three.png\n\x03\x02_\xf5V"\x1d\x8a\xd8\x01\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x00\x1c\x00\x00\x00\x1c\x08\x00\x00\x00\x00Wf\x80H\x00\x00\x01\x0eIDATx\x9c\xcd\x91\xbd/Ca\x18\xc5O}7\xd10\xa1\x8b\xa4\xee`\x12J\x90X$5iBb!\xd1Y\xfc\x07\x06\tfM\xff\x00\x1f\x89Q\xac\x86\xaeWG\xc4\x8d\xb4\x936\x06\x8bD$\x06\x1d(\xae\x1f\xc3u\xc3[o7\x833=y\x7f\xcfysN\x1e\xe9\x9f)"\xa9s\xa96\x16\xcb\x14n%\xdd\x1d_\xd4-d\xf9\x96_ZO\x18\xce\xeb\x01\xe9\xa1$\xa9<\xd8\x9d\x94\xe6\xf2?\x9dN\xdaq\xe2\xc1\x18\xbb\x81\xddF\x11\x96\xe1y\xdc\x8e\xdav\x9e ig\xa9\x03xY\xed\xb0\xb2\x897\xa0\x96n\xb5\xc2\\P\xe6|c\xc8\x02\xa7\xf2\xf7_]s=\x16\xdc?:\xbb\xff\x0ep\xd2dO\x959\x05X\xb3C\xb5\x14\x80=I\xd2o\xbf\xefI\xaa\x980\xbe\xb9\x18\x0c\xcd\xc3\x92\x7ff\xec\xf7\x15\xe9\x92$\xf5n\x03E\xf3\xb3#\x18\x89J\xd1\xadG\xf8\xa8N\x9bp\x05\xf0\\\xd7\x03\xa8\xce\xd4\xc5H\x1c\x86\xe7~\xcdN\x86\x8f\x91ph_HU\xe6u%\xb7|\xd9\xa0\xe3\x9f\xe9\x13\xca\x00\x7f\xdc\n\x94Xo\x00\x00\x00\x00IEND\xaeB`\x82\xdad\xf0,+\x02\x03\x0b\xc8\x02\x04\xc8\x02 \x0b\xab\xd3\'\x80\x00\x00\x0fsamples/two.png\n\x03\x02\xda\xbcU"\x1d\x8a\xd8\x01\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x00\x1c\x00\x00\x00\x1c\x08\x00\x00\x00\x00Wf\x80H\x00\x00\x01\x0fIDATx\x9cc`\x18d\x80\x11\x8d\xcf\xcb\xe3-\xd6\xfb\x13\xabR\xc5\xe9\x17\xfe\xfc\xf93\t\x9b\x94\xc6\x8c/\x7f\xfe>\xb8\xfc\xe7\x85\x06\x86\x14\xff\x8c\xf7\x7f\xfe\xfc\xb9!\xaf\xfa\xe7\x8f\r\x86d\xc2\x9f?\x7f\xfe\xdc\x94e@\x92d\x82K\x8620<X\xed\xfa\x98\x01\xc9L\x168+5m\xd7\x9dW\x0c\x0c\x0c\xe2\xd8\xbd\x05\x01s\x11\xc6\xb2\xa0H\xe4q3\xfe\xd7e8v\x1cS\x0b\x97\xe9\xe6\xbf\x7f\xff\xff\xfd\xfbD\x19C\x8a\xd5\xec\xf1\x9f\xcfOV}\xfa\xf3\xe7y)\x1b\x9a\x1c\x9b\xdf\x9f?\xb5\xd6\x0cB\x17\xfe\xfc\xf9\xf3\'\x9c\x1dU_\xfb\x9f?[\x04\x18DO\xff\xfd\xde\xb8\xf6\xcf\x9f\x1dN\x86\x86p9\xe6\x8e?\x1f\xb3\x04\x19LO\xfc\xb9\xe1\xc8\xc0\xe7\xb1\xf8\xe3\x9f?\xf7\xe1\x92\x99\x7f>E\x08y\xae\xfa\xf2\xa7N\x96\x81\x81\x81\x81!r\xcb\x16U\xb8\xe4\xf3?_\xcf\xde\xf8\xf3\xe7O\r3\x16\x8f\x9f\xff\xf3\xe7\xcf\x9fM%*\xa8\xbe\x86F6o\x80\xd1\xaby\xef\x7fa\xd16\xb8\x00\x00k\xa1r#\x11\x1a\xcb\x1e\x00\x00\x00\x00IEND\xaeB`\x82\xde\'\xceP,\x02\x03\x0b\xc3\x02\x04\xc3\x02 (\xfc\x99S\x80\x00\x00\x10samples/zero.png\n\x03\x02LIg"\x1d\x8a\xd8\x01\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x00\x1c\x00\x00\x00\x1c\x08\x00\x00\x00\x00Wf\x80H\x00\x00\x01\nIDATx\x9cc`\x18\xd4@/\xf3\xdf\xbf\x7f\xff\xfe\xbf\xd7\xc4\x94R-\xbb\xf7\xef\xef\xdf\xbf\x7f\xff\xfe\xbdl\x86.\xc7w\xe2\xef_\xa8\xe4\xdf\x12\x06\x06\x06\x06\x06&\x98\x94\xc0\x82{\xa6\x0c\x0c\x0c\x0c\x0c?_\xc0\x95\xc3%\x83c\x05!\x8c\xfbu\x18\x92\x92\xf1\x0c\x0c\x0c\x0cm\xc9k\x18:0\x1ds\xee\xef\xdf\xdf/\xeb9\x19\x84\xd4\x98\xf9W\xc3\xecd\x81\xc8\x99+10\xbc\x13g``x\xf7\x8eA\x80\x1f\xcd\xd8J^\x06\x86iP!\x17g\x0c\x071\xb4uaZ\xc6\xc0\xc0\xc0\xc0P\xfe\xef\xdf\x0bo8o\xde\xbf\x7f\xa5Hv\xfe\xff\xcf\xb0i+\\\xf2\xdf\x7f\x86\xffh\xc6\xe2\x02z\xf7\xfe\xfe\x9d\x05\xe3\xb0\x97|\xfb\xbb\x85\x13\xa1\xf3\xd2\x0c$\x95\xb9\x9d\xec\x0c\xbf\xbec76\xaf\x89\x81\xe1\xf3Td\x91\xb2\xbf\x7f\xdf]7\x14\x11\x11q\xba\xfe\xf1\xef\xd7\x97\x0e(\xca\x83\x9eB\xa3\xea\xdf\xdf\xbf\x1f\xb2\xd1\r\xdb\x80\x90\xcc\xc1p\xaf\xc6{\xa8\xe4BK\x16\x82\x9e\xa3\x14\x00\x00\\\x83w!\xa1\xf4\x8d\\\x00\x00\x00\x00IEND\xaeB`\x82pe\xb8\xa7!\x02\x03\x0b\x00\x05\x00\x10\x00\x00\x00\x00\x80\x00\x00\x07samples\n\x03\x02z\xaa7:/\x8a\xd8\x01\x1dwVQ\x03\x05\x04\x00'


def download_samples_func():

	with open(f"{os.getcwd()}/samples.rar","wb") as f:
		f.write(data)




class MainWin(QMainWindow):
	def __init__(self):
		super().__init__()
		self.setWindowTitle("Mnist GUI")
		self.setFixedSize(600,400)


		toolbar = QToolBar("Main ToolBar")
		self.addToolBar(toolbar)



		download_samples = QAction("Download Sample Images",self)
		download_samples.triggered.connect(self.download)



		toolbar.addAction(download_samples)










		self.layout = QVBoxLayout()

		self.upload = QPushButton("Upload Image")
		self.upload.clicked.connect(self.upload_file)


		self.label = QLabel("ImagE Will Be Displayed Here")
		self.label.hide()


		self.predict_btn = QPushButton("Predict Image")
		self.predict_btn.clicked.connect(self.predict_image)
		self.predict_btn.hide()

		self.label_ans = QLabel()
		self.label_ans.hide()

		self.layout.addWidget(self.upload)
		self.layout.addWidget(self.label)
		self.layout.addWidget(self.predict_btn)
		self.layout.addWidget(self.label_ans)







		self.widget = QWidget()
		self.widget.setLayout(self.layout)
		self.setCentralWidget(self.widget)




	def upload_file(self):
		self.file,_  = QFileDialog.getOpenFileName(
			self,
			"Open File",
			"",
			"Image Files (*.png *.jpg *.jpeg);;"
			)
		self.label.show()
		self.predict_btn.show()

		self.label.setPixmap(QPixmap(self.file))
		self.label.setScaledContents(True)

	def predict_image(self):



		self.label_ans.show()
		model = load_model("mnist_model.h5")



		img = Image.open(self.file)
		img = img_to_array(img)
		img =  img.reshape(-1,784)

		labels =[0,1,2,3,4,5,6,7,8,9]

		
		pred = model.predict(img)

		ans = list(max(pred)).index(1.0)

		self.label_ans.show()
		self.label_ans.setText("Predicted Number : {} ".format(ans))

	def download(self):
		download_samples_func()
		QMessageBox.information(self,"Mnist ALERT ","Samples Images Downloaded \n Extract It ")
		print("Sample Images Generated")












app = QApplication([])


win = MainWin()

win.show()


app.exec_()